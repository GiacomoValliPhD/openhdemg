<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>openhdemg.openhdemg_gui &mdash; openhdemg 0.1.0-beta documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            openhdemg
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">openhdemg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openhdemg.html">openhdemg package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../openhdemg.library.html">openhdemg.library package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">openhdemg</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">openhdemg.openhdemg_gui</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for openhdemg.openhdemg_gui</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This file contains the gui functionalities of openhdemg.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">import</span> <span class="nn">customtkinter</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span><span class="p">,</span> <span class="n">filedialog</span><span class="p">,</span> <span class="n">Canvas</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">StringVar</span><span class="p">,</span> <span class="n">Tk</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">E</span>
<span class="kn">from</span> <span class="nn">pandastable</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">config</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">platform</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="kn">import</span> <span class="n">FigureCanvasTkAgg</span><span class="p">,</span> <span class="n">NavigationToolbar2Tk</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">openhdemg.library</span> <span class="k">as</span> <span class="nn">openhdemg</span>


<div class="viewcode-block" id="emgGUI"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI">[docs]</a><span class="k">class</span> <span class="nc">emgGUI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class representing a Tkinter TK instance.</span>

<span class="sd">    This class is used to create a graphical user interface for</span>
<span class="sd">    the Open_HD-EMG library.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    self.auto_eval : int, default 0</span>
<span class="sd">        If auto &gt; 0, the script automatically removes the offset based on the number</span>
<span class="sd">        of samples passed in input.</span>
<span class="sd">    self.b_firings_rec : int, default 4</span>
<span class="sd">        The number of firings at recruitment and derecruitment to consider for the</span>
<span class="sd">        calculation of the DR.</span>
<span class="sd">    self.b_firings_ste : int, default 10</span>
<span class="sd">        The number of firings to consider for the calculation of the DR at the start and at the end</span>
<span class="sd">        of the steady-state phase.</span>
<span class="sd">    self.canvas : matplotlib.backends.backend_tkagg</span>
<span class="sd">        Canvas for plotting figures inside the GUI.</span>
<span class="sd">    self.channels : int or list</span>
<span class="sd">        The channel (int) or channels (list of int) to plot.</span>
<span class="sd">        The list can be passed as a manually-written with: &quot;0,1,2,3,4,5...,n&quot;,</span>
<span class="sd">        channels is expected to be with base 0.</span>
<span class="sd">    self.cutoff_freq : int, default 20</span>
<span class="sd">        The cut-off frequency in Hz.</span>
<span class="sd">    self.ct_event : str, default &quot;rt_dert&quot;</span>
<span class="sd">        When to calculate the thresholds. Input parameters for event_ are:</span>
<span class="sd">            &quot;rt_dert&quot; means that both recruitment and derecruitment tresholds will be calculated.</span>
<span class="sd">            &quot;rt&quot; means that only recruitment tresholds will be calculated.</span>
<span class="sd">            &quot;dert&quot; means that only derecruitment tresholds will be calculated.</span>
<span class="sd">    self.dr_event : str, default &quot;rec_derec_steady&quot;</span>
<span class="sd">        When to calculate the DR. Input parameters for event_ are:</span>
<span class="sd">            &quot;rec_derec_steady&quot; means that the DR is calculated at recruitment, derecruitment and</span>
<span class="sd">            during the steady-state phase.</span>
<span class="sd">            &quot;rec&quot; means that the DR is calculated at recruitment.</span>
<span class="sd">            &quot;derec&quot; means that the DR is calculated at derecruitment.</span>
<span class="sd">            &quot;rec_derec&quot; means that the DR is calculated at recruitment and derecruitment.</span>
<span class="sd">            &quot;steady&quot; means that the DR is calculated during the steady-state phase.</span>
<span class="sd">    self.end_area, self.start_area : int</span>
<span class="sd">        The start and end of the selection for file resizing (can be used for code automation).</span>
<span class="sd">    self.exportable_df : pd.DataFrame</span>
<span class="sd">        A pd.DataFrame containing the results of the analysis.</span>
<span class="sd">    self.fig : matplotlib.figure</span>
<span class="sd">        Figure to be plotted on Canvas.</span>
<span class="sd">    self.filename : str</span>
<span class="sd">        String and name of the file to be analysed.</span>
<span class="sd">    self.filepath : str</span>
<span class="sd">        String containing the path to EMG file selected for analysis.</span>
<span class="sd">    self.filetype : str</span>
<span class="sd">        String containing the filetype of import EMG file.</span>
<span class="sd">        Filetype can be &quot;OTB&quot;, &quot;Demuse&quot;, or &quot;Refsig&quot;.</span>
<span class="sd">    self.filter_order : int, default 4</span>
<span class="sd">        The filter order.</span>
<span class="sd">    self.firings_rec : int, default 4</span>
<span class="sd">        The number of firings at recruitment and derecruitment to consider for the calculation</span>
<span class="sd">        of the DR.</span>
<span class="sd">    self.firings_ste : int, default 10</span>
<span class="sd">        The number of firings to consider for the calculation of the DR at the start and at the end</span>
<span class="sd">        of the steady-state phase.</span>
<span class="sd">    self.first_fig : matplotlib.figure</span>
<span class="sd">        Figure frame determinining size of all figures that are plotted on canvas.</span>
<span class="sd">    self.head : tk.toplevel</span>
<span class="sd">        New tk.toplevel instance created everytime upon opnening a new window. This is needed</span>
<span class="sd">        for having a seperate window open.</span>
<span class="sd">    self.left : tk.frame</span>
<span class="sd">        Left frame inside of master that contains all buttons and filespecs.</span>
<span class="sd">    self.linewidth : float, default 0.5</span>
<span class="sd">        The width of the vertical lines representing the MU firing.</span>
<span class="sd">    self.logo :</span>
<span class="sd">        String containing the path to image file containing logo of Open_HD-EMG.</span>
<span class="sd">    self.logo_canvas : tk.canvas</span>
<span class="sd">        Canvas to display logo of Open_HG-EMG when openend.</span>
<span class="sd">    self.master: tk</span>
<span class="sd">        TK master window containing all widget children for this GUI.</span>
<span class="sd">    self.mus_dr: pd.DataFrame</span>
<span class="sd">        A pd.DataFrame containing the requested DR.</span>
<span class="sd">    self.mu_numb : int or list, default &quot;all&quot;</span>
<span class="sd">        By default, IPTS of all the MUs is plotted.</span>
<span class="sd">        Otherwise, a single MU (int) or multiple MUs (list of int) can be specified.</span>
<span class="sd">        The list can be passed as a manually-written list: &quot;0,1,2,3,4,5,...,n&quot;,</span>
<span class="sd">        self.m_numb is expected to be with base 0 (i.e., the first MU in the file is the number 0).</span>
<span class="sd">    self.mu_numb_idr : int or list, default &quot;all&quot;</span>
<span class="sd">        By default, IDR of all the MUs is plotted.</span>
<span class="sd">        Otherwise, a single MU (int) or multiple MUs (list of int) can be specified.</span>
<span class="sd">        The list can be passed as a manually-written list: &quot;0,1,2,3,4,5,...,n&quot;,</span>
<span class="sd">        self.m_numb_idr is expected to be with base 0 (i.e., the first MU in the</span>
<span class="sd">        file is the number 0).</span>
<span class="sd">    self.mu_to_remove : int</span>
<span class="sd">        The MUs to remove. If a single MU has to be removed, this should be an</span>
<span class="sd">        int (number of the MU).</span>
<span class="sd">        self.mu_to_remove is expected to be with base 0</span>
<span class="sd">        (i.e., the first MU in the file is the number 0).</span>
<span class="sd">    self.mu_to_edit : int</span>
<span class="sd">        The MUs to edit singularly. If a single MU has to be edited, this should be an</span>
<span class="sd">        int (number of the MU).</span>
<span class="sd">        self.mu_to_edit is expected to be with base 0</span>
<span class="sd">        (i.e., the first MU in the file is the number 0).</span>
<span class="sd">    self.mu_thresholds : pd.DataFrame</span>
<span class="sd">        A DataFrame containing the requested thresholds.</span>
<span class="sd">    self.mvc : float</span>
<span class="sd">        The MVC value in the original unit of measurement.</span>
<span class="sd">    self.mvc_df : pd.DataFrame</span>
<span class="sd">        A Dataframe containing the detected MVC value.</span>
<span class="sd">    self.offsetval: float, default 0</span>
<span class="sd">        Value of the offset. If offsetval is 0 (default), the user will be asked to manually</span>
<span class="sd">        select an aerea to compute the offset value.</span>
<span class="sd">        Otherwise, the value passed to offsetval will be used. Negative offsetval can be passed.</span>
<span class="sd">    self.resdict : dict</span>
<span class="sd">        Dictionary derived from input EMG file for further analysis.</span>
<span class="sd">    self.rfd_df : pd.DataFrame</span>
<span class="sd">        A Dataframe containing the calculated RFD values.</span>
<span class="sd">    self.rfdms : list, default [50, 100, 150, 200]</span>
<span class="sd">        Milliseconds (ms). A list containing the ranges in ms to calculate the RFD.</span>
<span class="sd">    self.right : tk.frame</span>
<span class="sd">        Left frame inside of master that contains plotting canvas.</span>
<span class="sd">    self.terminal : ttk.Labelframe</span>
<span class="sd">        Tkinter labelframe that is used to display the results table in the GUI.</span>
<span class="sd">    self.mat_code : str</span>
<span class="sd">        The code containing the matrix identification number.</span>
<span class="sd">    self.mat_orientation : int</span>
<span class="sd">        The orientation of the matrix in degrees. Can be 0, 180.</span>
<span class="sd">    self.deriv_config : str</span>
<span class="sd">        The Method used to calculate the MUs deviation.</span>
<span class="sd">    self.muap_config : str</span>
<span class="sd">        The Method used to calculate the MUs deviation.</span>
<span class="sd">    self.deriv_matrix : str</span>
<span class="sd">        Column of the matrix to be plotted.</span>
<span class="sd">    self.size_fig : str, default [20,15]</span>
<span class="sd">        Size of the figure to be plotted in centimeter.</span>
<span class="sd">    self.ref_but : str, default &quot;False&quot;</span>
<span class="sd">        String value used to determine if reference signal should be</span>
<span class="sd">        added to the plot.</span>
<span class="sd">    self.time_but : str, default &quot;False&quot;</span>
<span class="sd">        String value used to determine if time in seconds should be used</span>
<span class="sd">        in x-axis of plotting.</span>
<span class="sd">    muap_munum : int</span>
<span class="sd">        Number of motor unit to be plotted.</span>
<span class="sd">    muap_time : int</span>
<span class="sd">        Time window to be plotted.</span>
<span class="sd">    self.info : tk.PhotoImage</span>
<span class="sd">        Information Icon displayed in GUI.</span>
<span class="sd">    self.online : tk.Photoimage</span>
<span class="sd">        Online Icon displayed in GUI.</span>
<span class="sd">    self.redirect : tk.PhotoImage</span>
<span class="sd">        Redirection Icon displayed in GUI.</span>
<span class="sd">    self.contact : tk.PhotoImage</span>
<span class="sd">        Contact Icon displayed in GUI.</span>
<span class="sd">    self.cite : tk.PhotoImage</span>
<span class="sd">        Citation Icon displayed in GUI.</span>
<span class="sd">    self.otb_combobox : ttk.Combobox</span>
<span class="sd">        Combobox appearing in main GUI window or advanced</span>
<span class="sd">        analysis window when OTB files are loaded. Contains</span>
<span class="sd">        the extension factor for OTB files.</span>
<span class="sd">        Stringvariable containing the</span>
<span class="sd">    self.extension_factor : tk.Stringvar()</span>
<span class="sd">        Stringvariable containing the OTB extension factor value.</span>
<span class="sd">    self.advanced_method : tk.Stringvar()</span>
<span class="sd">        Stringvariable containing the selected method of advanced</span>
<span class="sd">        analysis.</span>
<span class="sd">    self.emgfile1 : pd.Dataframe</span>
<span class="sd">        Dataframe object containing the loaded first emgfile used</span>
<span class="sd">        for MU tracking.</span>
<span class="sd">    self.emgfile2 : pd.Dataframe</span>
<span class="sd">        Dataframe object containing the loaded first emgfile used</span>
<span class="sd">        for MU tracking.</span>
<span class="sd">    self.thresh_adv : tk.Stringvar()</span>
<span class="sd">        Stringvariable containing the selected threshold for MU tracking.</span>
<span class="sd">    self.filter_adv : tk.Boolenvar()</span>
<span class="sd">        Boolean determining whether filtering should be applied during MU</span>
<span class="sd">        tracking.</span>
<span class="sd">    self.show_adv : tk.Boolenvar()</span>
<span class="sd">        Boolean determining whether results of MU tracking should be plotted.</span>
<span class="sd">    self.exclude_thres : tk.Boolenvar()</span>
<span class="sd">        Boolean determining whether values below treshold should be excluded</span>
<span class="sd">        during MU tracking.</span>
<span class="sd">    self.which_adv : tk.Stringvar()</span>
<span class="sd">        Stringvariable determining how MU duplicates are removed.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    __init__(master)</span>
<span class="sd">        Initializes GUI class and main GUI window (master).</span>
<span class="sd">    get_file_input()</span>
<span class="sd">        Gets emgfile location and respective file is loaded.</span>
<span class="sd">        Executed when button &quot;Load File&quot; in master GUI window pressed.</span>
<span class="sd">    save_emgfile()</span>
<span class="sd">        Saves the edited emgfile dictionary to a .json file.</span>
<span class="sd">        Executed when button &quot;Save File&quot; in master GUI window pressed.</span>
<span class="sd">    export_to_excel()</span>
<span class="sd">        Saves the analysis results to a .xlsx file.</span>
<span class="sd">        Executed when button &quot;Save Results&quot; in master GUI window pressed.</span>
<span class="sd">    reset_analysis()</span>
<span class="sd">        Resets the whole analysis, restores the original input file and the graph.</span>
<span class="sd">        Executed when button &quot;Reset analysis&quot; in master GUI window pressed.</span>
<span class="sd">    in_gui_plotting()</span>
<span class="sd">        Method used for creating plot inside the GUI (on the GUI canvas).</span>
<span class="sd">        Executed when button &quot;View MUs&quot; in master GUI window pressed.</span>
<span class="sd">    sort_mus()</span>
<span class="sd">        Method used to sort motor units in Plot according to recruitement order.</span>
<span class="sd">        Executed when button &quot;Sort MUs&quot; in master GUI window pressed.</span>
<span class="sd">    remove_mus()</span>
<span class="sd">        Opens seperate window to select motor units to be removed.</span>
<span class="sd">        Executed when button &quot;Remove MUs&quot; in master GUI window pressed.</span>
<span class="sd">    remove()</span>
<span class="sd">        Method used to remove single motor units.</span>
<span class="sd">    edit_refsig()</span>
<span class="sd">        Opens seperate window to edit emg reference signal.</span>
<span class="sd">        Executed when button &quot;RefSig Editing&quot; in master GUI window pressed.</span>
<span class="sd">    filter_refsig()</span>
<span class="sd">        Method used to filter the emg reference signal.</span>
<span class="sd">    remove_offset()</span>
<span class="sd">        Method used to remove offset of emg reference signal.</span>
<span class="sd">    resize_file()</span>
<span class="sd">        Opens seperate window to resize emg file / reference signal.</span>
<span class="sd">        Executed when button &quot;Resize File&quot; in master GUI window pressed.</span>
<span class="sd">    select_resize()</span>
<span class="sd">        Method used to select start/end of resizing area manually on plot.</span>
<span class="sd">    resize_emgfile()</span>
<span class="sd">        Method used to resize the emg file according to specified start/end.</span>
<span class="sd">    analyze_force()</span>
<span class="sd">        Opens seperate window to analyze force signal/values.</span>
<span class="sd">        Executed when button &quot;Analyze force&quot; in master GUI window pressed.</span>
<span class="sd">    get_mvc()</span>
<span class="sd">        Method used to calculate/select MVC.</span>
<span class="sd">    det_rfd()</span>
<span class="sd">        Method used to calculated RFD based on selected startpoint.</span>
<span class="sd">    mu_analysis()</span>
<span class="sd">        Opens seperate window to calculated specific motor unit properties.</span>
<span class="sd">        Executed when button &quot;MU properties&quot; in master GUI window pressed.</span>
<span class="sd">    compute_mu_threshold()</span>
<span class="sd">        Method used to calculate motor unit recruitement thresholds.</span>
<span class="sd">    compute_mu_dr()</span>
<span class="sd">       Method used to calculate motor unit discharge rate.</span>
<span class="sd">    basic_mus_analysis()</span>
<span class="sd">        Method used to calculate basic motor unit properties.</span>
<span class="sd">    plot_emg()</span>
<span class="sd">        Opens seperate window to plot emgsignal/motor unit properties.</span>
<span class="sd">        Executed when button &quot;Plot EMG&quot; in master GUI window pressed.</span>
<span class="sd">    plt_emgsignal()</span>
<span class="sd">        Method used to plot emgsignal.</span>
<span class="sd">    plt_idr()</span>
<span class="sd">        Method used to plot instanteous discharge rate.</span>
<span class="sd">    plt_ipts()</span>
<span class="sd">        Method used to plot the motor unit puls train (i.e., non-binary firing)</span>
<span class="sd">    plt_refsignal()</span>
<span class="sd">        Method used to plot the motor unit reference signal.</span>
<span class="sd">    plt_mupulses()</span>
<span class="sd">        Method used to plot the motor unit pulses.</span>
<span class="sd">    plot_derivation()</span>
<span class="sd">        Method to plot the differential derivation of the RAW_SIGNAL</span>
<span class="sd">        by matrix column.</span>
<span class="sd">    plot_muaps()</span>
<span class="sd">        Method to plot motor unit action potenital obtained from STA</span>
<span class="sd">        from one or multiple MUs.</span>
<span class="sd">    open_pdf()</span>
<span class="sd">        Method to open a PDF file in a seperate window.</span>
<span class="sd">    advanced_analysis()</span>
<span class="sd">        Method to open top-level windows based on the selected advanced method.</span>
<span class="sd">    on_filetype_change()</span>
<span class="sd">        Method do display extension factor combobx when filetype loaded is</span>
<span class="sd">        OTB.</span>
<span class="sd">    open_emgfil1()</span>
<span class="sd">                Method to open EMG file based on the selected file type and extension factor.</span>
<span class="sd">    open_emgfile2()</span>
<span class="sd">        Method to open EMG file based on the selected file type and extension factor.</span>
<span class="sd">    track_mus()</span>
<span class="sd">        Method to perform MUs tracking on the loaded EMG files.</span>
<span class="sd">    display_results()</span>
<span class="sd">        Method used to display result table containing analysis results.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Please note that altough we created a GUI class, the included methods/</span>
<span class="sd">    instances are highly specific. We did not conceptualize the methods/instances</span>
<span class="sd">    to be used seperately. Similar functionalities are available in the library</span>
<span class="sd">    and were specifically coded to be used seperately/singularly.</span>

<span class="sd">    Most instance methods of this class heavily rely on the functions provided in</span>
<span class="sd">    the library. In the section &quot;See Also&quot; at each instance method, the reader is</span>
<span class="sd">    referred to the corresponding function and extensive documentation in the library.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="emgGUI.__init__"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialization of master GUI window upon calling.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        master: tk</span>
<span class="sd">            tk class object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set up GUI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">master</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Open_HD-EMG&quot;</span><span class="p">)</span>
        <span class="n">master_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
        <span class="n">iconpath</span> <span class="o">=</span> <span class="n">master_path</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.ico&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="n">iconpath</span><span class="p">)</span>

        <span class="c1"># Create left side framing for functionalities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10 10 12 12&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">W</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Style</span>
        <span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
        <span class="n">style</span><span class="o">.</span><span class="n">theme_use</span><span class="p">(</span><span class="s2">&quot;clam&quot;</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TToplevel&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TFrame&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
            <span class="s2">&quot;TLabel&quot;</span><span class="p">,</span>
            <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Lucida Sans&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
            <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">background</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TButton&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Lucida Sans&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TEntry&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Lucida Sans&quot;</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TCombobox&quot;</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;TLabelFrame&quot;</span><span class="p">,</span> <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Lucida Sans&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

        <span class="c1"># Specify Signal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">signal_value</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;OTB&quot;</span><span class="p">,</span> <span class="s2">&quot;DEMUSE&quot;</span><span class="p">,</span> <span class="s2">&quot;REFSIG&quot;</span><span class="p">,</span> <span class="s2">&quot;Open_HD-EMG&quot;</span><span class="p">,</span> <span class="s2">&quot;custom&quot;</span><span class="p">)</span>
        <span class="n">signal_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Signal&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span>
        <span class="p">)</span>
        <span class="n">signal_entry</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal_value</span>
        <span class="n">signal_entry</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
        <span class="n">signal_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Type of file&quot;</span><span class="p">)</span>
        <span class="c1"># Trace filetype to apply function when changeing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_filetype_change</span><span class="p">)</span>

        <span class="c1"># Load file</span>
        <span class="n">load</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Load File&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_file_input</span><span class="p">)</span>
        <span class="n">load</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="c1"># File specifications</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Filespecs:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;N Channels:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;N of MUs:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;File length:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">separator0</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator0</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># COMMENT: This is commented out because it is not yet functional.</span>
        <span class="c1"># Decompose file</span>
        <span class="c1"># decompose = ttk.Button(self.left,</span>
        <span class="c1">#                        text=&quot;Decompose&quot;,</span>
        <span class="c1">#                        command=self.decompose_file)</span>
        <span class="c1"># decompose.grid(row=3, column=0, sticky=W)</span>

        <span class="c1"># Save File</span>
        <span class="n">save</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save File&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_emgfile</span><span class="p">)</span>
        <span class="n">save</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
        <span class="n">separator1</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Export to Excel</span>
        <span class="n">export</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Save Results&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">export_to_excel</span>
        <span class="p">)</span>
        <span class="n">export</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># View Motor Unit Firings</span>
        <span class="n">firings</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;View MUs&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">in_gui_plotting</span><span class="p">)</span>
        <span class="n">firings</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="c1"># Sort Motor Units</span>
        <span class="n">sorting</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Sort MUs&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_mus</span><span class="p">)</span>
        <span class="n">sorting</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">separator2</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Remove Motor Units</span>
        <span class="n">remove_mus</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remove MUs&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_mus</span><span class="p">)</span>
        <span class="n">remove_mus</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="c1"># COMMENT: This is commented because it is not fully functional</span>
        <span class="c1"># Edit Motor Units</span>
        <span class="c1"># edit_mus = ttk.Button(self.left,</span>
        <span class="c1">#                      text=&quot;Edit MUs&quot;,</span>
        <span class="c1">#                      command=self.editing_mus)</span>
        <span class="c1"># edit_mus.grid(column=1, row=10, sticky=W)</span>

        <span class="n">separator3</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Filter Reference Signal</span>
        <span class="n">reference</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;RefSig Editing&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">edit_refsig</span>
        <span class="p">)</span>
        <span class="n">reference</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="c1"># Resize File</span>
        <span class="n">resize</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Resize File&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resize_file</span><span class="p">)</span>
        <span class="n">resize</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">separator4</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Force Analysis</span>
        <span class="n">force</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Analyse Force&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">analyze_force</span><span class="p">)</span>
        <span class="n">force</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
        <span class="n">separator5</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator5</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Motor Unit properties</span>
        <span class="n">mus</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;MU Properties&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_analysis</span><span class="p">)</span>
        <span class="n">mus</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
        <span class="n">separator6</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator6</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Plot EMG</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot EMG&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_emg</span><span class="p">)</span>
        <span class="n">plots</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
        <span class="n">separator7</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator7</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Reset Analysis</span>
        <span class="n">reset</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Reset Analysis&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_analysis</span>
        <span class="p">)</span>
        <span class="n">reset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Advanced tools</span>
        <span class="c1"># Create seperate style for this button</span>
        <span class="n">advanced_button_style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
        <span class="n">advanced_button_style</span><span class="o">.</span><span class="n">theme_use</span><span class="p">(</span><span class="s2">&quot;clam&quot;</span><span class="p">)</span>
        <span class="n">advanced_button_style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
            <span class="s2">&quot;B.TButton&quot;</span><span class="p">,</span>
            <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
            <span class="n">background</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Lucida Sans&quot;</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">advanced</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_advanced_tools</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Advanced Tools&quot;</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="s2">&quot;B.TButton&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">advanced</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Create right side framing for functionalities</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10 10 12 12&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Create empty figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span> <span class="o">/</span> <span class="mf">2.54</span><span class="p">,</span> <span class="mi">15</span> <span class="o">/</span> <span class="mf">2.54</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first_fig</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_tk_widget</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="c1"># Create logo figure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logo_canvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">590</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logo_canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">logo_path</span> <span class="o">=</span> <span class="n">master_path</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.png&quot;</span>  <span class="c1"># Get logo path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">logo_path</span><span class="p">)</span>

        <span class="c1"># self.matrix = tk.PhotoImage(file=&quot;Matrix_illustration.png&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logo_canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logo</span><span class="p">)</span>

        <span class="c1"># Create info button</span>
        <span class="c1"># Information Button</span>
        <span class="n">info_path</span> <span class="o">=</span> <span class="n">master_path</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/Info.png&quot;</span>  <span class="c1"># Get infor button path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">info_path</span><span class="p">)</span>
        <span class="n">info_button</span> <span class="o">=</span> <span class="n">customtkinter</span><span class="o">.</span><span class="n">CTkButton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
            <span class="n">fg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_pdf</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">info_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">E</span><span class="p">)</span>

        <span class="c1"># Button for online tutorials</span>
        <span class="n">online_path</span> <span class="o">=</span> <span class="n">master_path</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/Online.png&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">online</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">online_path</span><span class="p">)</span>
        <span class="n">online_button</span> <span class="o">=</span> <span class="n">customtkinter</span><span class="o">.</span><span class="n">CTkButton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">online</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
            <span class="n">fg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">online_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">E</span><span class="p">)</span>

        <span class="c1"># Button for dev information</span>
        <span class="n">redirect_path</span> <span class="o">=</span> <span class="n">master_path</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/Redirect.png&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redirect</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">redirect_path</span><span class="p">)</span>
        <span class="n">redirect_button</span> <span class="o">=</span> <span class="n">customtkinter</span><span class="o">.</span><span class="n">CTkButton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">redirect</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
            <span class="n">fg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">redirect_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">E</span><span class="p">)</span>

        <span class="c1"># Button for contact information</span>
        <span class="n">contact_path</span> <span class="o">=</span> <span class="n">master_path</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/Contact.png&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">contact</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">contact_path</span><span class="p">)</span>
        <span class="n">contact_button</span> <span class="o">=</span> <span class="n">customtkinter</span><span class="o">.</span><span class="n">CTkButton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">contact</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
            <span class="n">fg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">contact_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">E</span><span class="p">)</span>

        <span class="c1"># Button for citatoin information</span>
        <span class="n">cite_path</span> <span class="o">=</span> <span class="n">master_path</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/Cite.png&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cite</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">cite_path</span><span class="p">)</span>
        <span class="n">cite_button</span> <span class="o">=</span> <span class="n">customtkinter</span><span class="o">.</span><span class="n">CTkButton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cite</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
            <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
            <span class="n">fg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">cite_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">E</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">winfo_children</span><span class="p">():</span>
            <span class="n">child</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></div>

    <span class="c1">## Define functionalities for buttons used in GUI master window</span>

<div class="viewcode-block" id="emgGUI.get_file_input"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.get_file_input">[docs]</a>    <span class="k">def</span> <span class="nf">get_file_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance Method to load the file for analysis. The user is asked to select the file.</span>

<span class="sd">        Executed when the button &quot;Load File&quot; in master GUI window is pressed.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        emg_from_demuse, emg_from_otb, refsig_from_otb and emg_from_json in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;OTB&quot;</span><span class="p">,</span> <span class="s2">&quot;DEMUSE&quot;</span><span class="p">,</span> <span class="s2">&quot;Open_HD-EMG&quot;</span><span class="p">,</span> <span class="s2">&quot;custom&quot;</span><span class="p">]:</span>
                <span class="c1"># Check filetype for processing</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;OTB&quot;</span><span class="p">:</span>
                    <span class="c1"># Ask user to select the file</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Open OTB file&quot;</span><span class="p">,</span> <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;MATLAB files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.mat&quot;</span><span class="p">)]</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
                    <span class="c1"># Load file</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">emg_from_otb</span><span class="p">(</span>
                        <span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span>
                        <span class="n">ext_factor</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extension_factor</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;DEMUSE&quot;</span><span class="p">:</span>
                    <span class="c1"># Ask user to select the file</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Open DEMUSE file&quot;</span><span class="p">,</span> <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;MATLAB files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.mat&quot;</span><span class="p">)]</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>

                    <span class="c1"># load file</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">emg_from_demuse</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Open_HD-EMG&quot;</span><span class="p">:</span>
                    <span class="c1"># Ask user to select the file</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Open JSON file&quot;</span><span class="p">,</span> <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;JSON files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.json&quot;</span><span class="p">)]</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>

                    <span class="c1"># load Open_HD-EMG (.json)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">emg_from_json</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Ask user to select the file</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Open CUSTOM file&quot;</span><span class="p">,</span>
                        <span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;CSV files&quot;</span><span class="p">,</span> <span class="s2">&quot;.csv&quot;</span><span class="p">)],</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>

                    <span class="c1"># load refsig</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">emg_from_customcsv</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>

                <span class="c1"># Get filename</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_path</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>

                <span class="c1"># Add filename to label</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>

                <span class="c1"># Add filespecs</span>
                <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;RAW_SIGNAL&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                <span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
                <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;NUMBER_OF_MUS&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                    <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;EMG_LENGTH&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                    <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Ask user to select the file</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Open REFSIG file&quot;</span><span class="p">,</span>
                    <span class="n">filetypes</span><span class="o">=</span><span class="p">[</span>
                        <span class="p">(</span><span class="s2">&quot;MATLAB files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.mat&quot;</span><span class="p">),</span>
                        <span class="p">(</span><span class="s2">&quot;JSON files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.json&quot;</span><span class="p">),</span>
                    <span class="p">],</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
                <span class="c1"># Get filename</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_path</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>

                <span class="c1"># Add filename to label</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
                <span class="c1"># load refsig</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">refsig_from_otb</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>
                <span class="c1"># Recondifgure labels for refsig</span>
                <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;REF_SIGNAL&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                <span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
                <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
                <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;        &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                    <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
                <span class="s2">&quot;When an OTB file is loaded, make sure to &quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">specify an extension factor (number) first.&quot;</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.on_filetype_change"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.on_filetype_change">[docs]</a>    <span class="k">def</span> <span class="nf">on_filetype_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is called when the value of the filetype variable is changed.</span>
<span class="sd">        When the filetype is set to &quot;OTB&quot; it will create a second combobox on the grid at column 0 and row 2,</span>
<span class="sd">        and when the filetype is set to something else it will remove the second combobox from the grid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add a combobox containing the OTB extension factors</span>
        <span class="c1"># in case an OTB file is loaded</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;OTB&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extension_factor</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">otb_combobox</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="p">[</span>
                    <span class="s2">&quot;8&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;9&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;10&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;11&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;12&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;13&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;14&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;15&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;16&quot;</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extension_factor</span><span class="p">,</span>
                <span class="n">state</span><span class="o">=</span><span class="s2">&quot;readonly&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">otb_combobox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">otb_combobox</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Extension Factor&quot;</span><span class="p">)</span>

        <span class="c1"># Forget widget when filetype is changes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;otb_combobox&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">otb_combobox</span><span class="o">.</span><span class="n">grid_forget</span><span class="p">()</span></div>

<div class="viewcode-block" id="emgGUI.decompose_file"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.decompose_file">[docs]</a>    <span class="k">def</span> <span class="nf">decompose_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="emgGUI.save_emgfile"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.save_emgfile">[docs]</a>    <span class="k">def</span> <span class="nf">save_emgfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to save the edited emgfile. Results are saves in .json file.</span>

<span class="sd">        Executed when the button &quot;Save File&quot; in master GUI window is pressed.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When file was not loaded in the GUI.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        save_json_emgfile in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Ask user to select the directory and file name</span>
            <span class="n">save_filepath</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">asksaveasfilename</span><span class="p">(</span>
                <span class="n">defaultextension</span><span class="o">=</span><span class="s2">&quot;.*&quot;</span><span class="p">,</span>
                <span class="n">filetypes</span><span class="o">=</span><span class="p">((</span><span class="s2">&quot;JSON files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.json&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;all files&quot;</span><span class="p">,</span> <span class="s2">&quot;*.*&quot;</span><span class="p">)),</span>
            <span class="p">)</span>

            <span class="c1"># Get emgfile</span>
            <span class="n">save_emg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span>

            <span class="c1"># Save json file</span>
            <span class="n">openhdemg</span><span class="o">.</span><span class="n">save_json_emgfile</span><span class="p">(</span><span class="n">emgfile</span><span class="o">=</span><span class="n">save_emg</span><span class="p">,</span> <span class="n">filepath</span><span class="o">=</span><span class="n">save_filepath</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.export_to_excel"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.export_to_excel">[docs]</a>    <span class="k">def</span> <span class="nf">export_to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instnace method to export any prior analysis results. Results are saved in an excel sheet</span>
<span class="sd">        in a directory specified by the user.</span>

<span class="sd">        Executed when button &quot;Save Results&quot; in master GUI window is pressed.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        IndexError</span>
<span class="sd">            When no analysis has been performed prior to attempted savig.</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file was loaded in the GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Ask user to select the directory</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askdirectory</span><span class="p">()</span>

            <span class="c1"># Define excel writer</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;/Results_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.xlsx&quot;</span><span class="p">)</span>

            <span class="c1"># Check for attributes and write sheets</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;mvc_df&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mvc_df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;MVC&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;rfd&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rfd</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;RFD&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;exportable_df&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exportable_df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Basic MU Properties&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;mus_dr&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mus_dr</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;MU Discharge Rate&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;mu_thresholds&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mu_thresholds</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;MU Thresholds&quot;</span><span class="p">)</span>

            <span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Please conduct at least one analysis before saving&quot;</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
                <span class="s2">&quot;If /Results.xlsx already opened, please close.&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Otherwise ignore as you propably canceled the saving progress.&quot;</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.reset_analysis"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.reset_analysis">[docs]</a>    <span class="k">def</span> <span class="nf">reset_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to restore the GUI to base data. Any analysis progress will be deleted by</span>
<span class="sd">        reloading the original file.</span>

<span class="sd">        Executed when button &quot;Reset Analysis&quot; in master GUI window is pressed. The emgfile is</span>
<span class="sd">        updated to its original state.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file was loaded in the GUI.</span>
<span class="sd">        FileNotFoundError</span>
<span class="sd">            When no file was loaded in the GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get user input and check whether analysis wants to be truly resetted</span>
        <span class="k">if</span> <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span>
            <span class="s2">&quot;Attention&quot;</span><span class="p">,</span> <span class="s2">&quot;Do you really want to reset the analysis?&quot;</span>
        <span class="p">):</span>
            <span class="c1"># user decided to rest analysis</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># reload original file</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;OTB&quot;</span><span class="p">,</span> <span class="s2">&quot;DEMUSE&quot;</span><span class="p">,</span> <span class="s2">&quot;Open_HD-EMG&quot;</span><span class="p">,</span> <span class="s2">&quot;custom&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;OTB&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">emg_from_otb</span><span class="p">(</span>
                            <span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span>
                            <span class="n">ext_factor</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extension_factor</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                        <span class="p">)</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;DEMUSE&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">emg_from_demuse</span><span class="p">(</span>
                            <span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span>
                        <span class="p">)</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Open_HD-EMG&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">emg_from_json</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;custom&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">emg_from_customcsv</span><span class="p">(</span>
                            <span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span>
                        <span class="p">)</span>

                    <span class="c1"># Update Filespecs</span>
                    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;RAW_SIGNAL&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
                    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;NUMBER_OF_MUS&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                        <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;EMG_LENGTH&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                        <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># load refsig</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">refsig_from_otb</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>
                    <span class="c1"># Recondifgure labels for refsig</span>
                    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;REF_SIGNAL&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
                    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
                    <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;        &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                        <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
                    <span class="p">)</span>

                <span class="c1"># Update Plot</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;fig&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">in_gui_plotting</span><span class="p">()</span>

                <span class="c1"># Clear frame for output</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;terminal&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Result Output&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                        <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">row</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span>
                        <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">pady</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                        <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span>
                    <span class="p">)</span>

            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
                <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.open_advanced_tools"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.open_advanced_tools">[docs]</a>    <span class="k">def</span> <span class="nf">open_advanced_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a window for advanced analysis tools.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Open window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Advanced Tools Window&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.ico&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

        <span class="c1"># Add Label</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Select tool and matrix:&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Verdana&quot;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Analysis Tool</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Analysis Tool&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Add Selection Combobox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">advanced_method</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">adv_box</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">advanced_method</span>
        <span class="p">)</span>
        <span class="n">adv_box</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Motor Unit Tracking&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Duplicate Removal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Conduction Velocity&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">adv_box</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
        <span class="n">adv_box</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">adv_box</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Motor Unit Tracking&quot;</span><span class="p">)</span>

        <span class="c1"># Matrix Orientation</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Matrix Orientation*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation_adv</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">orientation</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation_adv</span>
        <span class="p">)</span>
        <span class="n">orientation</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;180&quot;</span><span class="p">)</span>
        <span class="n">orientation</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
        <span class="n">orientation</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation_adv</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;180&quot;</span><span class="p">)</span>

        <span class="c1"># Matrix code</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Matrix Code*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat_code_adv</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">matrix_code</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_code_adv</span>
        <span class="p">)</span>
        <span class="n">matrix_code</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;GR08MM1305&quot;</span><span class="p">,</span> <span class="s2">&quot;GR04MM1305&quot;</span><span class="p">)</span>
        <span class="n">matrix_code</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
        <span class="n">matrix_code</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat_code_adv</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;GR08MM1305&quot;</span><span class="p">)</span>

        <span class="c1"># Instruction</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;*Ignored for DEMUSE files, </span><span class="se">\n</span><span class="s2">insert random values&quot;</span><span class="p">,</span>
            <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="c1"># Analysis Button</span>
        <span class="n">adv_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Advanced Analysis&quot;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">advanced_analysis</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="s2">&quot;B.TButton&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">adv_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

        <span class="c1"># Add padding to widgets</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="o">.</span><span class="n">winfo_children</span><span class="p">():</span>
            <span class="n">child</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.open_pdf"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.open_pdf">[docs]</a>    <span class="k">def</span> <span class="nf">open_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to open a PDF file in a seperate window.</span>

<span class="sd">        The standard program for opening PDF files is used.</span>
<span class="sd">        The file can be handled independantly from the GUI.</span>
<span class="sd">        The specific usecase here is to open a tutorial for the</span>
<span class="sd">        &quot;Plot Window&quot; offline.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get file path</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./gui_files/test.pdf&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="c1"># Check user OS for pdf opening</span>
        <span class="k">if</span> <span class="n">platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;win32&quot;</span><span class="p">,</span> <span class="s2">&quot;linux&quot;</span><span class="p">):</span>
            <span class="c1"># Windows/linux option</span>
            <span class="n">webbrowser</span><span class="o">.</span><span class="n">open_new</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;darwin&quot;</span><span class="p">:</span>
            <span class="c1"># Mac option</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;open </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Plotting inside of GUI</span>

<div class="viewcode-block" id="emgGUI.in_gui_plotting"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.in_gui_plotting">[docs]</a>    <span class="k">def</span> <span class="nf">in_gui_plotting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="s2">&quot;idr&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to plot any analysis results in the GUI for inspection. Plots are updated</span>
<span class="sd">        during the analysis process.</span>

<span class="sd">        Executed when button &quot;View MUs&quot; in master GUI window is pressed or when the original</span>
<span class="sd">        input file is changed.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file was loaded in the GUI.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        plot_refsig, plot_idr in the library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;REFSIG&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_refsig</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">showimmediately</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">plot</span> <span class="o">==</span> <span class="s2">&quot;idr&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_idr</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">showimmediately</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">plot</span> <span class="o">==</span> <span class="s2">&quot;refsig_fil&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_refsig</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">showimmediately</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">plot</span> <span class="o">==</span> <span class="s2">&quot;refsig_off&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_refsig</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">showimmediately</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_tk_widget</span><span class="p">()</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar2Tk</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">pack_toolbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">toolbar</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Sorting of motor units</span>

<div class="viewcode-block" id="emgGUI.sort_mus"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.sort_mus">[docs]</a>    <span class="k">def</span> <span class="nf">sort_mus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to sort motor units ascending according to recruitement order.</span>

<span class="sd">        Executed when button &quot;Sort MUs&quot; in master GUI window is pressed. The plot of the MUs</span>
<span class="sd">        and the emgfile are subsequently updated.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file was loaded in the GUI.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        sort_mus in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Sort emgfile</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">sort_mus</span><span class="p">(</span><span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">)</span>

            <span class="c1"># Update plot</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;fig&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">in_gui_plotting</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Removal of single motor units</span>

<div class="viewcode-block" id="emgGUI.remove_mus"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.remove_mus">[docs]</a>    <span class="k">def</span> <span class="nf">remove_mus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to open &quot;Motor Unit Removal Window&quot;. Further option to select and</span>
<span class="sd">        remove MUs are displayed.</span>

<span class="sd">        Executed when button &quot;Remove MUs&quot; in master GUI window is pressed.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;resdict&quot;</span><span class="p">):</span>
            <span class="c1"># Create new window</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Motor Unit Removal Window&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.ico&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

            <span class="c1"># Select Motor Unit</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Select MU:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mu_to_remove</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">removed_mu_value</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;NUMBER_OF_MUS&quot;</span><span class="p">])]</span>
            <span class="n">removed_mu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_to_remove</span>
            <span class="p">)</span>
            <span class="n">removed_mu</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">removed_mu_value</span>
            <span class="n">removed_mu</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
            <span class="n">removed_mu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

            <span class="c1"># Remove Motor unit</span>
            <span class="n">remove</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remove MU&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove</span><span class="p">)</span>
            <span class="n">remove</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.remove"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance methof that actually removes a selected motor unit based on user specification.</span>

<span class="sd">        Executed when button &quot;Remove MU&quot; in Motor Unit Removal Window is pressed.</span>
<span class="sd">        The emgfile and the plot are subsequently updated.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        delete_mus in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Get resdict with MU removed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">delete_mus</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">munumber</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_to_remove</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="c1"># Upate MU number</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;NUMBER_OF_MUS&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># Update selection field</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mu_to_remove</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">removed_mu_value</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;NUMBER_OF_MUS&quot;</span><span class="p">])]</span>
            <span class="n">removed_mu</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_to_remove</span>
            <span class="p">)</span>
            <span class="n">removed_mu</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">removed_mu_value</span>
            <span class="n">removed_mu</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
            <span class="n">removed_mu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

            <span class="c1"># Update plot</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;fig&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">in_gui_plotting</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Editing of single motor Units</span>

    <span class="c1"># def editing_mus(self):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Instance method to edit sindle motor units. For now, this contains only plotting single MUs.</span>
    <span class="c1">#     More options will be added.</span>

    <span class="c1">#     THIS PART IS NOT YET INTEGRATED IN THE GUI.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>

    <span class="c1">#     # Create new window</span>
    <span class="c1">#     self.head = tk.Toplevel(bg=&#39;LightBlue4&#39;)</span>
    <span class="c1">#     self.head.title(&quot;Motor Unit Eiditing Window&quot;)</span>
    <span class="c1">#     self.head.grab_set()</span>

    <span class="c1">#     # Select Motor Unit</span>
    <span class="c1">#     ttk.Label(self.head, text=&quot;Select MU:&quot;).grid(column=0, row=0, sticky=W, padx=5, pady=5)</span>

    <span class="c1">#     self.mu_to_edit = StringVar()</span>
    <span class="c1">#     edit_mu_value = [*range(0, self.resdict[&quot;NUMBER_OF_MUS&quot;])]</span>
    <span class="c1">#     edit_mu = ttk.Combobox(self.head, width=10, textvariable=self.mu_to_edit)</span>
    <span class="c1">#     edit_mu[&quot;values&quot;] = edit_mu_value</span>
    <span class="c1">#     edit_mu[&quot;state&quot;] = &quot;readonly&quot;</span>
    <span class="c1">#     edit_mu.grid(column=1, row=0, sticky=(W,E), padx=5, pady=5)</span>

    <span class="c1">#     # Button to plot MU</span>
    <span class="c1">#     single_mu = ttk.Button(self.head,</span>
    <span class="c1">#                           text=&quot;View single MU&quot;,</span>
    <span class="c1">#                           command=self.view_single_mu)</span>
    <span class="c1">#     single_mu.grid(column=1, row=1, sticky=(W,E), padx=5, pady=5)</span>

    <span class="c1"># def view_single_mu(self):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Instance method that plots single selected MU.</span>

    <span class="c1">#     THIS PART IS NOT YET INTEGRATED IN THE GUI.</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     # Make figure</span>
    <span class="c1">#     fig = openhdemg.plot_idr(emgfile=self.resdict,</span>
    <span class="c1">#                              munumber=int(self.mu_to_edit.get()),</span>
    <span class="c1">#                              showimmediately=False)</span>
    <span class="c1">#     # Create canvas and plot</span>
    <span class="c1">#     canvas = FigureCanvasTkAgg(fig, master=self.head)</span>
    <span class="c1">#     canvas_plot = canvas.get_tk_widget()</span>
    <span class="c1">#     canvas_plot.grid(column=1, row=2, sticky=(W,E))</span>
    <span class="c1">#     # Place matplotlib toolbar</span>
    <span class="c1">#     toolbar = NavigationToolbar2Tk(canvas, self.head, pack_toolbar=False)</span>
    <span class="c1">#     toolbar.grid(row=3, column=1)</span>
    <span class="c1">#     # terminate matplotlib to ensure GUI shutdown when closed</span>
    <span class="c1">#     plt.close()</span>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Editing of Reference EMG Signal</span>

<div class="viewcode-block" id="emgGUI.edit_refsig"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.edit_refsig">[docs]</a>    <span class="k">def</span> <span class="nf">edit_refsig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to open &quot;Reference Signal Editing Window&quot;. Options for</span>
<span class="sd">        refsig filtering and offset removal are displayed.</span>

<span class="sd">        Executed when button &quot;RefSig Editing&quot; in master GUI window is pressed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create new window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Reference Signal Eiditing Window&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.ico&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

        <span class="c1"># Filter Refsig</span>
        <span class="c1"># Define Labels</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Filter Order&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Cutoff Freq&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="c1"># Fiter button</span>
        <span class="n">basic</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Filter Refsig&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_refsig</span><span class="p">)</span>
        <span class="n">basic</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span><span class="p">)</span>
        <span class="n">order</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff_freq</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">cutoff</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoff_freq</span><span class="p">)</span>
        <span class="n">cutoff</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cutoff_freq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

        <span class="c1"># Remove offset of reference signal</span>
        <span class="n">separator2</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Offset Value&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Automatic Offset&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># Offset removal button</span>
        <span class="n">basic2</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remove Offset&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_offset</span><span class="p">)</span>
        <span class="n">basic2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">offsetval</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">offsetval</span><span class="p">)</span>
        <span class="n">offset</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offsetval</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">auto_eval</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">auto</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">auto_eval</span><span class="p">)</span>
        <span class="n">auto</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auto_eval</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Add padding to all children widgets of head</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">winfo_children</span><span class="p">():</span>
            <span class="n">child</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></div>

    <span class="c1">### Define functions for Refsig editing</span>

<div class="viewcode-block" id="emgGUI.filter_refsig"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.filter_refsig">[docs]</a>    <span class="k">def</span> <span class="nf">filter_refsig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method that filters the refig based on user selected specs.</span>

<span class="sd">        Executed when button &quot;Filter Refsig&quot; in Reference Signal Editing Window is pressed.</span>
<span class="sd">        The emgfile and the GUI plot are updated.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            When no reference signal file is available.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        filter_refsig in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Filter refsig</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">filter_refsig</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_order</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">cutoff</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cutoff_freq</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
            <span class="p">)</span>
            <span class="c1"># Plot filtered Refsig</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">in_gui_plotting</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="s2">&quot;refsig_fil&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a Refsig file is loaded.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.remove_offset"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.remove_offset">[docs]</a>    <span class="k">def</span> <span class="nf">remove_offset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance Method that remves user specified/selected Refsig offset.</span>

<span class="sd">        Executed when button &quot;Remove offset&quot; in Reference Signal Editing Window is pressed.</span>
<span class="sd">        The emgfile and the GUI plot are updated.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        TypeError</span>
<span class="sd">            When no reference signal file is available</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        remove_offset in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Remove offset</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">remove_offset</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">offsetval</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offsetval</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">auto</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auto_eval</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
            <span class="p">)</span>
            <span class="c1"># Update Plot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">in_gui_plotting</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="s2">&quot;refsig_off&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a Refsig file is loaded.&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Resize EMG File</span>

<div class="viewcode-block" id="emgGUI.resize_file"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.resize_file">[docs]</a>    <span class="k">def</span> <span class="nf">resize_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to open &quot;Resize EMG File Window&quot;. Options to resize</span>
<span class="sd">        the emgfile by specified area are displayed.</span>

<span class="sd">        Executed when button &quot;Resize File&quot; in master GUI window is pressed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create new window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Resize EMG File Window&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.ico&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

        <span class="c1"># Enter start point of resizing area</span>
        <span class="n">select_res</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Select Resize&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">select_resize</span>
        <span class="p">)</span>
        <span class="n">select_res</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Enter Startpoint:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_area</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_area</span><span class="p">)</span>
        <span class="n">start</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_area</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">120</span><span class="p">)</span>

        <span class="c1"># Enter end point of resizing area</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Enter Endpoint:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">end_area</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end_area</span><span class="p">)</span>
        <span class="n">end</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_area</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">2560</span><span class="p">)</span>

        <span class="c1"># Resize Button</span>
        <span class="n">resize</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Resize File&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resize_emgfile</span><span class="p">)</span>
        <span class="n">resize</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></div>

    <span class="c1">### Define function for resizing</span>

<div class="viewcode-block" id="emgGUI.select_resize"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.select_resize">[docs]</a>    <span class="k">def</span> <span class="nf">select_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to get resize area from user specification on plot and</span>
<span class="sd">        resize emgfile.</span>

<span class="sd">        Executed when button &quot;Select Resize&quot; is pressed in Resize file window.</span>
<span class="sd">        The emgfile and the GUI plot are updated.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to analysis.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        showselect, resize_emgfile in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Open selection window for user</span>
            <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">showselect</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Select the start/end area to consider then press enter&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">resize_emgfile</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="p">[</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="c1"># Update Plot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">in_gui_plotting</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.resize_emgfile"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.resize_emgfile">[docs]</a>    <span class="k">def</span> <span class="nf">resize_emgfile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to get resize are from user specification and</span>
<span class="sd">        resize the emgfile.</span>

<span class="sd">        Executed when button &quot;Resize File&quot; in Resize file window is pressed.</span>
<span class="sd">        The emgfile and the GUI plot are updated.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to analysis.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        resize_emgfile in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Resize the file.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">start_</span><span class="p">,</span> <span class="n">end_</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">resize_emgfile</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">area</span><span class="o">=</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_area</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_area</span><span class="o">.</span><span class="n">get</span><span class="p">())],</span>
            <span class="p">)</span>
            <span class="c1"># Define dictionary for pandas</span>
            <span class="n">res_dic</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;Length&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;EMG_LENGTH&quot;</span><span class="p">]],</span>
                <span class="s2">&quot;Start&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">start_</span><span class="p">],</span>
                <span class="s2">&quot;End&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">end_</span><span class="p">],</span>
            <span class="p">}</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">res_dic</span><span class="p">)</span>

            <span class="c1"># Display resizing specs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">display_results</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

            <span class="c1"># Update file length value</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;EMG_LENGTH&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># Update plot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">in_gui_plotting</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Analysis of Force</span>

<div class="viewcode-block" id="emgGUI.analyze_force"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.analyze_force">[docs]</a>    <span class="k">def</span> <span class="nf">analyze_force</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to open &quot;Force analysis Window&quot;.</span>
<span class="sd">        Options to analyse force singal are displayed.</span>

<span class="sd">        Executed when &quot;Analyse Force&quot; button in master GUI window is pressed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create new window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Force Analysis Window&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.ico&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

        <span class="c1"># Get MVC</span>
        <span class="n">get_mvf</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Get MVC&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_mvc</span><span class="p">)</span>
        <span class="n">get_mvf</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="c1"># Get RFD</span>
        <span class="n">separator1</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;RFD miliseconds&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">)</span>

        <span class="n">get_rfd</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Get RFD&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rfd</span><span class="p">)</span>
        <span class="n">get_rfd</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rfdms</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">milisecond</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rfdms</span><span class="p">)</span>
        <span class="n">milisecond</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rfdms</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;50,100,150,200&quot;</span><span class="p">)</span></div>

    <span class="c1">### Define functions for force analysis</span>

<div class="viewcode-block" id="emgGUI.get_mvc"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.get_mvc">[docs]</a>    <span class="k">def</span> <span class="nf">get_mvc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance methof to retrieve calculated MVC based on user selection.</span>

<span class="sd">        Executed when button &quot;Get MVC&quot; in Analyze Force window is pressed.</span>
<span class="sd">        The Results of the analysis are displayed in the results terminal.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to analysis.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        get_mvc in the library</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># get MVC</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mvc</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">get_mvc</span><span class="p">(</span><span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">)</span>
            <span class="c1"># Define dictionary for pandas</span>
            <span class="n">mvc_dic</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;MVC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mvc</span><span class="p">]}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mvc_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">mvc_dic</span><span class="p">)</span>
            <span class="c1"># Display results</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">display_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mvc_df</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.get_rfd"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.get_rfd">[docs]</a>    <span class="k">def</span> <span class="nf">get_rfd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to calculate RFD at specified timepoints based on user selection.</span>

<span class="sd">        Executed when button &quot;Get RFD&quot; in Analyze Force window is pressed.</span>
<span class="sd">        The Results of the analysis are displayed in the results terminal.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to analysis.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        get_rfd in library</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Define list for RFD computation</span>
            <span class="n">ms</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rfdms</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="c1"># Split the string at ,</span>
            <span class="n">ms_list</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="c1"># Use comprehension to iterate through</span>
            <span class="n">ms_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ms_list</span><span class="p">]</span>
            <span class="c1"># Calculate rfd</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rfd</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">compute_rfd</span><span class="p">(</span><span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">ms_list</span><span class="p">)</span>
            <span class="c1"># Display results</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">display_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rfd</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Make sure a file is loaded.&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Analysis of motor unit properties</span>

<div class="viewcode-block" id="emgGUI.mu_analysis"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.mu_analysis">[docs]</a>    <span class="k">def</span> <span class="nf">mu_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to open &quot;Motor Unit Properties Window&quot;. Options to analyse motor</span>
<span class="sd">        unit properties such as recruitement threshold, discharge rate or</span>
<span class="sd">        basic properties computing are displayed.</span>

<span class="sd">        Executed when button &quot;MU Properties&quot; button in master GUI window is pressed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create new window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Motor Unit Properties Window&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.ico&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

        <span class="c1"># MVC Entry</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Enter MVC[n]:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mvc_value</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">enter_mvc</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mvc_value</span><span class="p">)</span>
        <span class="n">enter_mvc</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Compute MU re-/derecruitement threshold</span>
        <span class="n">separator</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">thresh</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Compute threshold&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_mu_threshold</span>
        <span class="p">)</span>
        <span class="n">thresh</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ct_event</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">ct_events_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ct_event</span><span class="p">)</span>
        <span class="n">ct_events_entry</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;rt&quot;</span><span class="p">,</span> <span class="s2">&quot;dert&quot;</span><span class="p">,</span> <span class="s2">&quot;rt_dert&quot;</span><span class="p">)</span>
        <span class="n">ct_events_entry</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
        <span class="n">ct_events_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ct_event</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Event&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ct_type</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">ct_types_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ct_type</span><span class="p">)</span>
        <span class="n">ct_types_entry</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;abs&quot;</span><span class="p">,</span> <span class="s2">&quot;rel&quot;</span><span class="p">,</span> <span class="s2">&quot;abs_rel&quot;</span><span class="p">)</span>
        <span class="n">ct_types_entry</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
        <span class="n">ct_types_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ct_type</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">)</span>

        <span class="c1"># Compute motor unit discharge rate</span>
        <span class="n">separator1</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Firings at Rec&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Firings Start/End Steady&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">dr_rate</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Compute discharge rate&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_mu_dr</span>
        <span class="p">)</span>
        <span class="n">dr_rate</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">firings_rec</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">firings_1</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">firings_rec</span><span class="p">)</span>
        <span class="n">firings_1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firings_rec</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">firings_ste</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">firings_2</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">firings_ste</span><span class="p">)</span>
        <span class="n">firings_2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">firings_ste</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dr_event</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">dr_events_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dr_event</span><span class="p">)</span>
        <span class="n">dr_events_entry</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;rec&quot;</span><span class="p">,</span>
            <span class="s2">&quot;derec&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rec_derec&quot;</span><span class="p">,</span>
            <span class="s2">&quot;steady&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rec_derec_steady&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">dr_events_entry</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
        <span class="n">dr_events_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">E</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dr_event</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Event&quot;</span><span class="p">)</span>

        <span class="c1"># Compute basic motor unit properties</span>
        <span class="n">separator2</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
        <span class="n">separator2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Firings at Rec&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Firings Start/End Steady&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">basic</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Basic MU properties&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">basic_mus_properties</span>
        <span class="p">)</span>
        <span class="n">basic</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">b_firings_rec</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">b_firings_1</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_firings_rec</span><span class="p">)</span>
        <span class="n">b_firings_1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_firings_rec</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">b_firings_ste</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">b_firings_2</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">b_firings_ste</span><span class="p">)</span>
        <span class="n">b_firings_2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_firings_ste</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">winfo_children</span><span class="p">():</span>
            <span class="n">child</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></div>

    <span class="c1">### Define functions for motor unit property calculation</span>

<div class="viewcode-block" id="emgGUI.compute_mu_threshold"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.compute_mu_threshold">[docs]</a>    <span class="k">def</span> <span class="nf">compute_mu_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to compute the motor unit recruitement thresholds</span>
<span class="sd">        based on user selection of events and types.</span>

<span class="sd">        Executed when button &quot;Compute threshold&quot; in Motor Unit Properties Window</span>
<span class="sd">        is pressed. The analysis results are displayed in the result terminal.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to calculation.</span>
<span class="sd">        ValueError</span>
<span class="sd">            When entered MVC is not valid (inexistent).</span>
<span class="sd">        AssertionError</span>
<span class="sd">            When types/events are not specified.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        compute_thresholds in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Compute thresholds</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mu_thresholds</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">compute_thresholds</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">event_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ct_event</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">type_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ct_type</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">mvc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mvc_value</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
            <span class="p">)</span>
            <span class="c1"># Display results</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">display_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_thresholds</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Load file prior to computation.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid MVC.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Specify Event and/or Type.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.compute_mu_dr"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.compute_mu_dr">[docs]</a>    <span class="k">def</span> <span class="nf">compute_mu_dr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to compute the motor unit discharge rate</span>
<span class="sd">        based on user selection of Firings and Events.</span>

<span class="sd">        Executed when button &quot;Compute discharge rate&quot; in Motor Unit Properties Window</span>
<span class="sd">        is pressed. The analysis results are displayed in the result terminal.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to calculation.</span>
<span class="sd">        ValueError</span>
<span class="sd">            When entered Firings values are not valid (inexistent).</span>
<span class="sd">        AssertionError</span>
<span class="sd">            When types/events are not specified.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        compute_dr in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Compute discharge rates</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mus_dr</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">compute_dr</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">n_firings_RecDerec</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">firings_rec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">n_firings_steady</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">firings_ste</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">event_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dr_event</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="c1"># Display results</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">display_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mus_dr</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Load file prior to computation.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid Firings value.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Specify Event and/or Type.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.basic_mus_properties"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.basic_mus_properties">[docs]</a>    <span class="k">def</span> <span class="nf">basic_mus_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to compute basic motor unit properties based in user</span>
<span class="sd">        selection in plot.</span>

<span class="sd">        Executed when button &quot;Basic MU properties&quot; in Motor Unit Properties Window</span>
<span class="sd">        is pressed. The analysis results are displayed in the result terminal.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to calculation.</span>
<span class="sd">        ValueError</span>
<span class="sd">            When entered Firings values are not valid (inexistent).</span>
<span class="sd">        AssertionError</span>
<span class="sd">            When types/events are not specified.</span>
<span class="sd">        UnboundLocalError</span>
<span class="sd">            When start/end area for calculations are specified wrongly.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        basic_mus_properties in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Calculate properties</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exportable_df</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">basic_mus_properties</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">n_firings_RecDerec</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_firings_rec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">n_firings_steady</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_firings_ste</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">mvc</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mvc_value</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
            <span class="p">)</span>
            <span class="c1"># Display results</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">display_results</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportable_df</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Load file prior to computation.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid MVC.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Specify Event and/or Type.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Select start/end area again.&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Plot EMG</span>

<div class="viewcode-block" id="emgGUI.plot_emg"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.plot_emg">[docs]</a>    <span class="k">def</span> <span class="nf">plot_emg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to open &quot;Plot Window&quot;. Options to create</span>
<span class="sd">        several plots from the emgfile are displayed.</span>

<span class="sd">        Executed when button &quot;Plot EMG&quot; in master GUI window is pressed.</span>
<span class="sd">        The plots are displayed in seperate windows.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Create new window</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Plot Window&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.ico&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

            <span class="c1"># Reference signal</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Reference signal&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">ref_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span>
                <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="p">,</span>
                <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
                <span class="n">onvalue</span><span class="o">=</span><span class="s2">&quot;True&quot;</span><span class="p">,</span>
                <span class="n">offvalue</span><span class="o">=</span><span class="s2">&quot;False&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ref_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Time</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Time in seconds&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">time_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span>
                <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="p">,</span>
                <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
                <span class="n">onvalue</span><span class="o">=</span><span class="s2">&quot;True&quot;</span><span class="p">,</span>
                <span class="n">offvalue</span><span class="o">=</span><span class="s2">&quot;False&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">time_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Figure Size</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Figure size in cm (h,w)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">fig_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;20,15&quot;</span><span class="p">)</span>
            <span class="n">fig_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

            <span class="c1"># Plot emgsig</span>
            <span class="n">plt_emgsig</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot EMGsig&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plt_emgsignal</span>
            <span class="p">)</span>
            <span class="n">plt_emgsig</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">channel_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">channels</span>
            <span class="p">)</span>
            <span class="n">channel_entry</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0,1,2&quot;</span><span class="p">,</span> <span class="s2">&quot;0,1,2,3&quot;</span><span class="p">)</span>
            <span class="n">channel_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Channel Numbers&quot;</span><span class="p">)</span>

            <span class="c1"># Plot refsig</span>
            <span class="n">plt_refsig</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot REFsig&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plt_refsignal</span>
            <span class="p">)</span>
            <span class="n">plt_refsig</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

            <span class="c1"># Plot motor unit pulses</span>
            <span class="n">plt_pulses</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot MUpulses&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plt_mupulses</span>
            <span class="p">)</span>
            <span class="n">plt_pulses</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">linewidth</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">linewidth_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">linewidth</span>
            <span class="p">)</span>
            <span class="n">linewidth_entry</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;0.25&quot;</span><span class="p">,</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="s2">&quot;0.75&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="n">linewidth_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linewidth</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Linewidth&quot;</span><span class="p">)</span>

            <span class="c1"># Plot impulse train</span>
            <span class="n">plt_ipts</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot IPTS&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plt_ipts</span><span class="p">)</span>
            <span class="n">plt_ipts</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mu_numb</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">munumb_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_numb</span><span class="p">)</span>
            <span class="n">munumb_entry</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0,1,2&quot;</span><span class="p">,</span> <span class="s2">&quot;0,1,2,3&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">)</span>
            <span class="n">munumb_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mu_numb</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;MU Number&quot;</span><span class="p">)</span>

            <span class="c1"># Plot instantaneous discharge rate</span>
            <span class="n">plt_idr</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot IDR&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plt_idr</span><span class="p">)</span>
            <span class="n">plt_idr</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mu_numb_idr</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">munumb_entry_idr</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mu_numb_idr</span>
            <span class="p">)</span>
            <span class="n">munumb_entry_idr</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;0,1,2&quot;</span><span class="p">,</span> <span class="s2">&quot;0,1,2,3&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">)</span>
            <span class="n">munumb_entry_idr</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mu_numb_idr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;MU Number&quot;</span><span class="p">)</span>

            <span class="c1"># This section containes the code for column 3++</span>

            <span class="c1"># Separator</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Separator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ipady</span><span class="o">=</span><span class="mi">120</span>
            <span class="p">)</span>

            <span class="c1"># Matrix code</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Matrix Code*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mat_code</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">matrix_code</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_code</span><span class="p">)</span>
            <span class="n">matrix_code</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;GR08MM1305&quot;</span><span class="p">,</span> <span class="s2">&quot;GR04MM1305&quot;</span><span class="p">)</span>
            <span class="n">matrix_code</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
            <span class="n">matrix_code</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mat_code</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;GR08MM1305&quot;</span><span class="p">)</span>

            <span class="c1"># Matrix Orientation</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Orientation*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">orientation</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation</span>
            <span class="p">)</span>
            <span class="n">orientation</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;180&quot;</span><span class="p">)</span>
            <span class="n">orientation</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
            <span class="n">orientation</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;180&quot;</span><span class="p">)</span>

            <span class="c1"># Instruction</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span>
                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;*Ignored for DEMUSE files, insert random values&quot;</span><span class="p">,</span>
                <span class="n">font</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
            <span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>

            <span class="c1"># Plot derivation</span>
            <span class="c1"># Button</span>
            <span class="n">deriv_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot Derivation&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_derivation</span>
            <span class="p">)</span>
            <span class="n">deriv_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

            <span class="c1"># Combobox Config</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deriv_config</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">configuration</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deriv_config</span>
            <span class="p">)</span>
            <span class="n">configuration</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Single differential&quot;</span><span class="p">,</span> <span class="s2">&quot;Double differential&quot;</span><span class="p">)</span>
            <span class="n">configuration</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
            <span class="n">configuration</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deriv_config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Configuration&quot;</span><span class="p">)</span>

            <span class="c1"># Combobox Matrix</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deriv_matrix</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">mat_column</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deriv_matrix</span>
            <span class="p">)</span>
            <span class="n">mat_column</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;col0&quot;</span><span class="p">,</span> <span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">,</span> <span class="s2">&quot;col3&quot;</span><span class="p">,</span> <span class="s2">&quot;col4&quot;</span><span class="p">)</span>
            <span class="n">mat_column</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
            <span class="n">mat_column</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deriv_matrix</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Matrix column&quot;</span><span class="p">)</span>

            <span class="c1"># Motor unit action potential</span>
            <span class="c1"># Button</span>
            <span class="n">muap_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot MUAPs&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_muaps</span>
            <span class="p">)</span>
            <span class="n">muap_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

            <span class="c1"># Combobox Config</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">muap_config</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">config_muap</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">muap_config</span>
            <span class="p">)</span>
            <span class="n">config_muap</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Monopolar&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Single differential&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Double differential&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">config_muap</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
            <span class="n">config_muap</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">muap_config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Configuration&quot;</span><span class="p">)</span>

            <span class="c1"># Combobox MU Number</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">muap_munum</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">muap_munum</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">muap_munum</span><span class="p">)</span>
            <span class="n">mu_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">[</span><span class="s2">&quot;NUMBER_OF_MUS&quot;</span><span class="p">])]</span>
            <span class="n">muap_munum</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mu_numbers</span>
            <span class="n">muap_munum</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
            <span class="n">muap_munum</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">muap_munum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;MU Number&quot;</span><span class="p">)</span>

            <span class="c1"># Combobox Timewindow</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">muap_time</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">timewindow</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">muap_time</span><span class="p">)</span>
            <span class="n">timewindow</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;25&quot;</span><span class="p">,</span> <span class="s2">&quot;50&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span> <span class="s2">&quot;200&quot;</span><span class="p">)</span>
            <span class="n">timewindow</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">muap_time</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Timewindow (ms)&quot;</span><span class="p">)</span>

            <span class="c1"># Matrix Illustration Graphic</span>
            <span class="n">matrix_canvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>
            <span class="n">matrix_canvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
                <span class="o">+</span> <span class="s2">&quot;/gui_files/Matrix.png&quot;</span>
            <span class="p">)</span>
            <span class="n">matrix_canvas</span><span class="o">.</span><span class="n">create_image</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;nw&quot;</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>

            <span class="c1"># Information Button</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span>
                <span class="n">file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/Info.png&quot;</span>
            <span class="p">)</span>
            <span class="n">info_button</span> <span class="o">=</span> <span class="n">customtkinter</span><span class="o">.</span><span class="n">CTkButton</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span>
                <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">,</span>
                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                <span class="n">bg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
                <span class="n">fg_color</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">,</span>
                <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_pdf</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">info_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">E</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">winfo_children</span><span class="p">():</span>
                <span class="n">child</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Load file prior to computation.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span></div>

    <span class="c1">### Define functions for motor unit plotting</span>

<div class="viewcode-block" id="emgGUI.plt_emgsignal"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.plt_emgsignal">[docs]</a>    <span class="k">def</span> <span class="nf">plt_emgsignal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to plot the raw emg signal in an seperate plot window.</span>
<span class="sd">        The channels selected by the user are plotted. The plot can be saved and</span>
<span class="sd">        partly edited using the matplotlib options.</span>

<span class="sd">        Executed when button &quot;Plot EMGsig&quot; in Plot Window is pressed.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to calculation.</span>
<span class="sd">        ValueError</span>
<span class="sd">            When entered channel number is not valid (inexistent).</span>
<span class="sd">        KeyError</span>
<span class="sd">            When entered channel number is out of bounds.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        plot_emgsignal in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Create list of channels to be plotted</span>
            <span class="n">channels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="c1"># Create list of figsize</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">channels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">chan_list</span> <span class="o">=</span> <span class="n">channels</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">chan_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">chan_list</span><span class="p">]</span>

                <span class="c1"># Plot raw emg signal</span>
                <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_emgsig</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">channels</span><span class="o">=</span><span class="n">chan_list</span><span class="p">,</span>
                    <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Plot raw emg signal</span>
                <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_emgsig</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">channels</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">channels</span><span class="p">),</span>
                    <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid channel number.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid channel number.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.plt_refsignal"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.plt_refsignal">[docs]</a>    <span class="k">def</span> <span class="nf">plt_refsignal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to plot the reference signal in an seperate plot window.</span>
<span class="sd">        The plot can be saved and partly edited using the matplotlib options.</span>

<span class="sd">        Executed when button &quot;Plot REFsig&quot; in Plot Window is pressed.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to calculation.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        plot_refsig in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create list of figsize</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

        <span class="c1"># Plot reference signal</span>
        <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_refsig</span><span class="p">(</span>
            <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span> <span class="n">timeinseconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.plt_mupulses"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.plt_mupulses">[docs]</a>    <span class="k">def</span> <span class="nf">plt_mupulses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to plot the mu pulses in an seperate plot window.</span>
<span class="sd">        The linewidth selected by the user is used. The plot can be saved and</span>
<span class="sd">        partly edited using the matplotlib options.</span>

<span class="sd">        Executed when button &quot;Plot MUpulses&quot; in Plot Window is pressed.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to calculation.</span>
<span class="sd">        ValueError</span>
<span class="sd">            When entered channel number is not valid (inexistent).</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        plot_mupulses in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Create list of figsize</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

            <span class="c1"># Plot motor unig pulses</span>
            <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_mupulses</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">linewidths</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linewidth</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid linewidth number.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.plt_ipts"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.plt_ipts">[docs]</a>    <span class="k">def</span> <span class="nf">plt_ipts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to plot the motor unit pulse train in an seperate plot window.</span>
<span class="sd">        The motor units selected by the user are plotted. The plot can be saved and</span>
<span class="sd">        partly edited using the matplotlib options.</span>

<span class="sd">        Executed when button &quot;Plot IPTS&quot; in Plot Window is pressed.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to calculation.</span>
<span class="sd">        ValueError</span>
<span class="sd">            When entered motor unit number is not valid (inexistent).</span>
<span class="sd">        KeyError</span>
<span class="sd">            When entered motor number is out of bounds.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        plot_ipts in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Create list contaning motor units to be plotted</span>
            <span class="n">mu_numb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_numb</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="c1"># Create list of figsize</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

            <span class="k">if</span> <span class="n">mu_numb</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="c1"># Plot motor unit puls train in default</span>
                <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_ipts</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">mu_numb</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># Split at ,</span>
                <span class="n">mu_list</span> <span class="o">=</span> <span class="n">mu_numb</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="c1"># Use comprehension to loop troug mu_list</span>
                <span class="n">mu_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mu_list</span><span class="p">]</span>
                <span class="c1"># Plot motor unit puls train in default</span>
                <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_ipts</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">munumber</span><span class="o">=</span><span class="n">mu_list</span><span class="p">,</span>
                    <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Plot motor unit puls train in default</span>
                <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_ipts</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">munumber</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">mu_numb</span><span class="p">),</span>
                    <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid motor unit number.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid motor unit number.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.plt_idr"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.plt_idr">[docs]</a>    <span class="k">def</span> <span class="nf">plt_idr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to plot the instanteous discharge rate in an seperate plot window.</span>
<span class="sd">        The motor units selected by the user are plotted. The plot can be saved and</span>
<span class="sd">        partly edited using the matplotlib options.</span>

<span class="sd">        Executed when button &quot;Plot IDR&quot; in Plot Window is pressed.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            When no file is loaded prior to calculation.</span>
<span class="sd">        ValueError</span>
<span class="sd">            When entered channel number is not valid (inexistent).</span>
<span class="sd">        KeyError</span>
<span class="sd">            When entered channel number is out of bounds.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        plot_idr in library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mu_idr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu_numb_idr</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="c1"># Create list of figsize</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

            <span class="k">if</span> <span class="n">mu_idr</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="c1"># Plot instanteous discharge rate</span>
                <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_idr</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">mu_idr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">mu_list_idr</span> <span class="o">=</span> <span class="n">mu_idr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="n">mu_list_idr</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">mu_list_idr</span><span class="p">]</span>
                <span class="c1"># Plot instanteous discharge rate</span>
                <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_idr</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">munumber</span><span class="o">=</span><span class="n">mu_list_idr</span><span class="p">,</span>
                    <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Plot instanteous discharge rate</span>
                <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_idr</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">munumber</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">mu_idr</span><span class="p">),</span>
                    <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid motor unit number.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid motor unit number.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.plot_derivation"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.plot_derivation">[docs]</a>    <span class="k">def</span> <span class="nf">plot_derivation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method to plot the differential derivation of the RAW_SIGNAL by matrix column.</span>

<span class="sd">        Both the single and the double differencials can be plotted.</span>
<span class="sd">        This function is used to plot also the sorted RAW_SIGNAL.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Sort emg file</span>
            <span class="n">sorted_file</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">sort_rawemg</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_code</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">orientation</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
            <span class="p">)</span>

            <span class="c1"># calcualte derivation</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deriv_config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Single differential&quot;</span><span class="p">:</span>
                <span class="n">diff_file</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sorted_rawemg</span><span class="o">=</span><span class="n">sorted_file</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">deriv_config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Double differential&quot;</span><span class="p">:</span>
                <span class="n">diff_file</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">double_diff</span><span class="p">(</span><span class="n">sorted_rawemg</span><span class="o">=</span><span class="n">sorted_file</span><span class="p">)</span>

            <span class="c1"># Create list of figsize</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

            <span class="c1"># Plot deviation</span>
            <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_differentials</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">differential</span><span class="o">=</span><span class="n">diff_file</span><span class="p">,</span>
                <span class="n">column</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deriv_matrix</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">addrefsig</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_but</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">timeinseconds</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_sec</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Enter valid input parameters.&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Potenital error sources:&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Matrix Code&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Matrix Orientation&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Figure size&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid Configuration and Matrx Column.&quot;</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid Matrx Column.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.plot_muaps"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.plot_muaps">[docs]</a>    <span class="k">def</span> <span class="nf">plot_muaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance methos to plot motor unit action potenital obtained from STA from one or</span>
<span class="sd">        multiple MUs.</span>

<span class="sd">        There is no limit to the number of MUs and STA files that can be overplotted.</span>
<span class="sd">        ``Remember: the different STAs should be matched`` with same number of electrode,</span>
<span class="sd">        processing (i.e., differential) and computed on the same timewindow.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Sort emg file</span>
            <span class="n">sorted_file</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">sort_rawemg</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_code</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">orientation</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
            <span class="p">)</span>
            <span class="c1"># calcualte derivation</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">muap_config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Single differential&quot;</span><span class="p">:</span>
                <span class="n">diff_file</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">sorted_rawemg</span><span class="o">=</span><span class="n">sorted_file</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">muap_config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Double differential&quot;</span><span class="p">:</span>
                <span class="n">diff_file</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">double_diff</span><span class="p">(</span><span class="n">sorted_rawemg</span><span class="o">=</span><span class="n">sorted_file</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">muap_config</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Monopolar&quot;</span><span class="p">:</span>
                <span class="n">diff_file</span> <span class="o">=</span> <span class="n">sorted_file</span>

            <span class="c1"># Calculate STA dictionary</span>
            <span class="c1"># Plot deviation</span>
            <span class="n">sta_dict</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">sta</span><span class="p">(</span>
                <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                <span class="n">sorted_rawemg</span><span class="o">=</span><span class="n">diff_file</span><span class="p">,</span>
                <span class="n">firings</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
                <span class="n">timewindow</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">muap_time</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
            <span class="p">)</span>

            <span class="c1"># Create list of figsize</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_fig</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>

            <span class="c1"># Plot MUAPS</span>
            <span class="n">openhdemg</span><span class="o">.</span><span class="n">plot_muaps</span><span class="p">(</span><span class="n">sta_dict</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">muap_munum</span><span class="o">.</span><span class="n">get</span><span class="p">())],</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Enter valid input parameters.&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Potenital error sources:&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Matrix Code&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Matrix Orientation&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Figure size&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Timewindow&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - MU Number&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid Configuration.&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Information&quot;</span><span class="p">,</span> <span class="s2">&quot;Enter valid Matrx Column.&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Advanced Analysis</span>

<div class="viewcode-block" id="emgGUI.advanced_analysis"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.advanced_analysis">[docs]</a>    <span class="k">def</span> <span class="nf">advanced_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open top-level windows based on the selected advanced method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;MUs tracking window&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/gui_files/logo.ico&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">grab_set</span><span class="p">()</span>

        <span class="c1"># Specify Signal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">signal_value</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;OTB&quot;</span><span class="p">,</span> <span class="s2">&quot;DEMUSE&quot;</span><span class="p">,</span> <span class="s2">&quot;Open_HD-EMG&quot;</span><span class="p">,</span> <span class="s2">&quot;custom&quot;</span><span class="p">)</span>
        <span class="n">signal_entry</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Signal&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span>
        <span class="p">)</span>
        <span class="n">signal_entry</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal_value</span>
        <span class="n">signal_entry</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;readonly&quot;</span>
        <span class="n">signal_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Type of file&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_filetype_change_adv</span><span class="p">)</span>

        <span class="c1"># Load file</span>
        <span class="n">load1</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Load File 1&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_emgfile1</span><span class="p">)</span>
        <span class="n">load1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Load file</span>
        <span class="n">load2</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Load File 2&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_emgfile2</span><span class="p">)</span>
        <span class="n">load2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Threshold label</span>
        <span class="n">threshold_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Threshold:&quot;</span><span class="p">)</span>
        <span class="n">threshold_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

        <span class="c1"># Combobox for threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold_adv</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
        <span class="n">threshold_combobox</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span>
            <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
            <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold_adv</span><span class="p">,</span>
            <span class="n">state</span><span class="o">=</span><span class="s2">&quot;readonly&quot;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">threshold_combobox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold_adv</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span>

        <span class="c1"># Exclude below threshold</span>
        <span class="n">exclude_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Exclude below threshold&quot;</span><span class="p">)</span>
        <span class="n">exclude_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Add exclude checkbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exclude_thres</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="n">exclude_checkbox</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_thres</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span>
        <span class="p">)</span>
        <span class="n">exclude_checkbox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exclude_thres</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Filter</span>
        <span class="n">filter_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Filter&quot;</span><span class="p">)</span>
        <span class="n">filter_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

        <span class="c1"># Add filter checkbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_adv</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="n">filter_checkbox</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_adv</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span>
        <span class="p">)</span>
        <span class="n">filter_checkbox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filter_adv</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Exclude below threshold</span>
        <span class="n">show_label</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Show&quot;</span><span class="p">)</span>
        <span class="n">show_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="c1"># Add exclude checkbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_adv</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="n">show_checkbox</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_adv</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s2">&quot;LightBlue4&quot;</span>
        <span class="p">)</span>
        <span class="n">show_checkbox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

        <span class="c1"># Add button to execute MU tracking</span>
        <span class="n">track_button</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Track&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">track_mus</span><span class="p">)</span>
        <span class="n">track_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">))</span>

        <span class="c1"># Add padding</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">winfo_children</span><span class="p">():</span>
            <span class="n">child</span><span class="o">.</span><span class="n">grid_configure</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="c1"># Add Which widget and update the track button</span>
        <span class="c1"># to match functionalities required for duplicate removal</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">advanced_method</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Duplicate Removal&quot;</span><span class="p">:</span>
            <span class="c1"># Add Which label</span>
            <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Which&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
            <span class="c1"># Combobox for Which option</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">which_adv</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="n">which_combobox</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;munumber&quot;</span><span class="p">,</span> <span class="s2">&quot;SIL&quot;</span><span class="p">,</span> <span class="s2">&quot;PNR&quot;</span><span class="p">],</span>
                <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">which_adv</span><span class="p">,</span>
                <span class="n">state</span><span class="o">=</span><span class="s2">&quot;readonly&quot;</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">which_combobox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">which_adv</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;munumber&quot;</span><span class="p">)</span>

            <span class="c1"># Add button to execute MU tracking</span>
            <span class="n">track_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remove Duplicates&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_duplicates_between</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">advanced_method</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Conduction Velocity&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Destroy unnecessary pop-ups</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

                <span class="c1"># Sort emg file</span>
                <span class="n">sorted_rawemg</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">sort_rawemg</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_code_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="n">orientation</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="p">)</span>

                <span class="n">openhdemg</span><span class="o">.</span><span class="n">MUcv_gui</span><span class="p">(</span>
                    <span class="n">emgfile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resdict</span><span class="p">,</span>
                    <span class="n">sorted_rawemg</span><span class="o">=</span><span class="n">sorted_rawemg</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                    <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Please make sure to load a file&quot;</span>
                    <span class="o">+</span> <span class="s2">&quot;prior to Conduction velocity calculation.&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

        <span class="c1"># Destroy first window to avoid too many pop-ups</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_window</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span></div>

    <span class="c1">### Define function for advanced analysis tools</span>

<div class="viewcode-block" id="emgGUI.open_emgfile1"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.open_emgfile1">[docs]</a>    <span class="k">def</span> <span class="nf">open_emgfile1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open EMG file based on the selected file type and extension factor.</span>

<span class="sd">        This function is used to open and store the first emgfile that is</span>
<span class="sd">        required for the MU tracking. As both files required are loaded by</span>
<span class="sd">        different buttons, two functions storing the two files were created.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        open_emgfile1(), openhdemg.askopenfile()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Open OTB file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;OTB&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emgfile1</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">askopenfile</span><span class="p">(</span>
                <span class="n">filesource</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">otb_ext_factor</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extension_factor_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
            <span class="p">)</span>
        <span class="c1"># Open all other filetypes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emgfile1</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">askopenfile</span><span class="p">(</span>
                <span class="n">filesource</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
            <span class="p">)</span>

        <span class="c1"># Add filename to GUI</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;File 1 loaded&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.open_emgfile2"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.open_emgfile2">[docs]</a>    <span class="k">def</span> <span class="nf">open_emgfile2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open EMG file based on the selected file type and extension factor.</span>

<span class="sd">        This function is used to open and store the first emgfile that is</span>
<span class="sd">        required for the MU tracking. As both files required are loaded by</span>
<span class="sd">        different buttons, two functions storing the two files were created.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        open_emgfile1(), openhdemg.askopenfile()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Open OTB file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;OTB&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emgfile2</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">askopenfile</span><span class="p">(</span>
                <span class="n">filesource</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">otb_ext_factor</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extension_factor_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
            <span class="p">)</span>
        <span class="c1"># Open all other filetypes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emgfile2</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">askopenfile</span><span class="p">(</span>
                <span class="n">filesource</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
            <span class="p">)</span>

        <span class="c1"># Add filename to GUI</span>
        <span class="n">ttk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;File 2 loaded&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.on_filetype_change_adv"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.on_filetype_change_adv">[docs]</a>    <span class="k">def</span> <span class="nf">on_filetype_change_adv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is called when the value of the filetype variable is changed.</span>
<span class="sd">        When the filetype is set to &quot;OTB&quot; it will create a second combobox on the grid at column 0 and row 2,</span>
<span class="sd">        and when the filetype is set to something else it will remove the second combobox from the grid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Add a combobox containing the OTB extension factors</span>
        <span class="c1"># in case an OTB file is loaded</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;OTB&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extension_factor_adv</span> <span class="o">=</span> <span class="n">StringVar</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">otb_combobox</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Combobox</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span> <span class="s2">&quot;13&quot;</span><span class="p">,</span> <span class="s2">&quot;14&quot;</span><span class="p">,</span> <span class="s2">&quot;15&quot;</span><span class="p">,</span> <span class="s2">&quot;16&quot;</span><span class="p">],</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extension_factor_adv</span><span class="p">,</span>
                <span class="n">state</span><span class="o">=</span><span class="s2">&quot;readonly&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">otb_combobox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">otb_combobox</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Extension Factor&quot;</span><span class="p">)</span>

        <span class="c1"># Forget the widget in case the filetype is changed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;otb_combobox&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">otb_combobox</span><span class="o">.</span><span class="n">grid_forget</span><span class="p">()</span></div>

<div class="viewcode-block" id="emgGUI.track_mus"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.track_mus">[docs]</a>    <span class="k">def</span> <span class="nf">track_mus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform MUs tracking on the loaded EMG files.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The function uses the openhdemg.tracking</span>
<span class="sd">        function to perform the tracking of MUs.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            If the required EMG files have not been loaded.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the input parameters are not valid.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        openhdemg.tracking()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Track motor units</span>
            <span class="n">tracking_res</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">tracking</span><span class="p">(</span>
                <span class="n">emgfile1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">emgfile1</span><span class="p">,</span>
                <span class="n">emgfile2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">emgfile2</span><span class="p">,</span>
                <span class="n">threshold</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">matrixcode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_code_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">orientation</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">exclude_belowthreshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_thres</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="nb">filter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
            <span class="p">)</span>

            <span class="c1"># Add result terminal</span>
            <span class="n">track_terminal</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;MUs Tracking Result&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span>
            <span class="p">)</span>
            <span class="n">track_terminal</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
                <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">rowspan</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                <span class="n">pady</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span>
            <span class="p">)</span>

            <span class="c1"># Add table containing results to the label frame</span>
            <span class="n">track_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">track_terminal</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="n">tracking_res</span><span class="p">)</span>
            <span class="n">track_table</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Make sure to load all required EMG files prior to tracking.&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Enter valid input parameters.&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Potenital error sources:&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Extension Factor (in case of OTB file)&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Matrix Code&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Matrix Orientation&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Threshold&quot;</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.remove_duplicates_between"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.remove_duplicates_between">[docs]</a>    <span class="k">def</span> <span class="nf">remove_duplicates_between</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform duplicate removal between two EMG files.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The function uses the openhdemg.remove_duplicates_between function to remove duplicates between two EMG files.</span>
<span class="sd">        If the required parameters are not provided, the function will raise an AttributeError or ValueError.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        AttributeError</span>
<span class="sd">            If the required EMG files have not been loaded.</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the input parameters are not valid.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        openhdemg.remove_duplicates_between(), openhdemg.asksavefile()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Remove motor unit duplicates</span>
            <span class="n">emg_file1</span><span class="p">,</span> <span class="n">emg_file2</span> <span class="o">=</span> <span class="n">openhdemg</span><span class="o">.</span><span class="n">remove_duplicates_between</span><span class="p">(</span>
                <span class="n">emgfile1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">emgfile1</span><span class="p">,</span>
                <span class="n">emgfile2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">emgfile2</span><span class="p">,</span>
                <span class="n">threshold</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">threshold_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="n">matrixcode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_code_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">orientation</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_orientation_adv</span><span class="o">.</span><span class="n">get</span><span class="p">()),</span>
                <span class="nb">filter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">which</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">which_adv</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
            <span class="p">)</span>

            <span class="c1"># Save files</span>
            <span class="n">openhdemg</span><span class="o">.</span><span class="n">asksavefile</span><span class="p">(</span><span class="n">emg_file1</span><span class="p">)</span>
            <span class="n">openhdemg</span><span class="o">.</span><span class="n">asksavefile</span><span class="p">(</span><span class="n">emg_file2</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Make sure to load all required EMG files prior to tracking.&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">tk</span><span class="o">.</span><span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span>
                <span class="s2">&quot;Information&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Enter valid input parameters.&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Potenital error sources:&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Extension Factor (in case of OTB file)&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Matrix Code&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Matrix Orientation&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Threshold&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - Which&quot;</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="emgGUI.calculate_conduct_vel"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.calculate_conduct_vel">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_conduct_vel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Add result terminal</span>
        <span class="n">track_terminal</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Conduction Velocity&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span>
        <span class="p">)</span>
        <span class="n">track_terminal</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">rowspan</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">pady</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">),</span>
        <span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------------------------------------</span>
    <span class="c1"># Analysis results display</span>

<div class="viewcode-block" id="emgGUI.display_results"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.emgGUI.display_results">[docs]</a>    <span class="k">def</span> <span class="nf">display_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_df</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instance method that displays all analysis results in the</span>
<span class="sd">        output terminal using Pandastable. Input must be a Pandas dataframe.</span>

<span class="sd">        Executed trough functions with calculated anylsis results.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_df : pd.DataFrame</span>
<span class="sd">            Dataftame containing the analysis results.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create frame for output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">LabelFrame</span><span class="p">(</span>
            <span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Result Output&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">relief</span><span class="o">=</span><span class="s2">&quot;ridge&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Display results</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">terminal</span><span class="p">,</span>
            <span class="n">dataframe</span><span class="o">=</span><span class="n">input_df</span><span class="p">,</span>
            <span class="n">showtoolbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">showstatusbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Resize column width</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cellwidth&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
        <span class="n">config</span><span class="o">.</span><span class="n">apply_options</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span>

        <span class="c1"># Show results</span>
        <span class="n">table</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div></div>


<span class="c1"># -----------------------------------------------------------------------------------------------</span>
<div class="viewcode-block" id="run_main"><a class="viewcode-back" href="../../openhdemg.html#openhdemg.openhdemg_gui.run_main">[docs]</a><span class="k">def</span> <span class="nf">run_main</span><span class="p">():</span>
    <span class="c1"># Run GUI upon calling</span>
    <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
        <span class="n">emgGUI</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">Tk</span><span class="p">()</span>
    <span class="n">emgGUI</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Giacomo Valli.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>